<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link href="http://fonts.googleapis.com/css?family=Rosarivo:400,400italic|Happy+Monkey|Electrolize" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Browser.html">
<link rel="next" href="Dhcp.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Arp" rel="Chapter" href="Arp.html">
<link title="Browser" rel="Chapter" href="Browser.html">
<link title="Clock" rel="Chapter" href="Clock.html">
<link title="Dhcp" rel="Chapter" href="Dhcp.html">
<link title="Dhcpd" rel="Chapter" href="Dhcpd.html">
<link title="Dns" rel="Chapter" href="Dns.html">
<link title="Eth" rel="Chapter" href="Eth.html">
<link title="Host" rel="Chapter" href="Host.html">
<link title="Html" rel="Chapter" href="Html.html">
<link title="Http" rel="Chapter" href="Http.html">
<link title="Hub" rel="Chapter" href="Hub.html">
<link title="Icmp" rel="Chapter" href="Icmp.html">
<link title="Ip" rel="Chapter" href="Ip.html">
<link title="Localhost" rel="Chapter" href="Localhost.html">
<link title="Log" rel="Chapter" href="Log.html">
<link title="Metric" rel="Chapter" href="Metric.html">
<link title="Myadmin" rel="Chapter" href="Myadmin.html">
<link title="Net" rel="Chapter" href="Net.html">
<link title="Opache" rel="Chapter" href="Opache.html">
<link title="Packet" rel="Chapter" href="Packet.html">
<link title="Pcap" rel="Chapter" href="Pcap.html">
<link title="Peg" rel="Chapter" href="Peg.html">
<link title="Persist" rel="Chapter" href="Persist.html">
<link title="Router" rel="Chapter" href="Router.html">
<link title="Sim" rel="Chapter" href="Sim.html">
<link title="Sll" rel="Chapter" href="Sll.html">
<link title="Tcp" rel="Chapter" href="Tcp.html">
<link title="Tools" rel="Chapter" href="Tools.html">
<link title="Udp" rel="Chapter" href="Udp.html">
<link title="Url" rel="Chapter" href="Url.html">
<link title="Vlan" rel="Chapter" href="Vlan.html"><link title="Private Types" rel="Section" href="#2_PrivateTypes">
<link title="Current running time" rel="Section" href="#2_Currentrunningtime">
<title>Clock</title>
</head>
<body>
<div class="navbar"><a href="Browser.html">Previous</a>
&nbsp;<a href="index.html">Up</a>
&nbsp;<a href="Dhcp.html">Next</a>
</div>
<center><h1>Module <a href="type_Clock.html">Clock</a></h1></center>
<br>
<pre><span class="keyword">module</span> Clock: <code class="code"><span class="keyword">sig</span></code> <a href="Clock.html">..</a> <code class="code"><span class="keyword">end</span></code></pre>This module creates an alarm-clock that schedule registered events.
   There are two modes of operation: realtime and not realtime.
<p>

   When in realtime mode (the default), the clock will merely follow
   wall-clock. Then, scheduling an event in the future is equivalent to
   <code class="code"><span class="constructor">Unix</span>.sleep</code> for some time. This is not very interesting but is required
   whenever you plan to work with real network devices and outside world.  On
   the other hand, if your simulated network does not communicates with the
   outside world, for instance because your objective is to build a pcap file,
   then you can use not realtime mode and then play your simulation at full
   speed (and full CPU), and produce a pcap file representing, say, the
   workload of a day in minutes, or conversely a very busy hour in several
   hours but with all packets and accurate timestamps.<br>
<hr width="100%">
<pre><span id="VALdebug"><span class="keyword">val</span> <a href="code_VALClock.debug.html">debug</a></span> : <code class="type">bool</code></pre><pre><span id="VALrealtime"><span class="keyword">val</span> <a href="code_VALClock.realtime.html">realtime</a></span> : <code class="type">bool Batteries.ref</code></pre><br>
<span id="2_PrivateTypes"><h2>Private Types</h2></span><br>
<pre><span class="keyword">module</span> <a href="Clock.Time.html">Time</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Clock.Time.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Time.t represents a given timestamp (ie.
</div>
<pre><span class="keyword">module</span> <a href="Clock.Interval.html">Interval</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Clock.Interval.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
While Interval.t reprensents a time interval.
</div>
<pre><span id="VALprinter"><span class="keyword">val</span> <a href="code_VALClock.printer.html">printer</a></span> : <code class="type">'a BatIO.output -> Time.t -> unit</code></pre><br>
<span id="2_Currentrunningtime"><h2>Current running time</h2></span><br>
<pre><span class="keyword">module</span> <a href="Clock.Map.html">Map</a>: <code class="type">Batteries.Map.Make</code><code class="code">(</code><code class="code"><span class="keyword">sig</span></code><div class="sig_block"><pre><span id="TYPEt"><span class="keyword">type</span> <code class="type"></code>t</span> = <code class="type">Clock.Time.t</code> </pre>

<pre><span id="VALcompare"><span class="keyword">val</span> <a href="code_VALClock.Map.compare.html">compare</a></span> : <code class="type">t -> t -> int</code></pre></div><code class="code"><span class="keyword">end</span></code><code class="code">)</code></pre><br><code><span id="TYPEclock"><span class="keyword">type</span> <code class="type"></code>clock</span> = {</code><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span class="keyword">mutable&nbsp;</span>now&nbsp;: <code class="type">Time.t</code>;</code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span class="keyword">mutable&nbsp;</span>events&nbsp;: <code class="type">(unit -> unit) Map.t</code>;</code></td>

</tr></table>
}

<div class="info">
A clock is a current timestamp and the set of future events.<br>
</div>

<pre><span id="VALcurrent"><span class="keyword">val</span> <a href="code_VALClock.current.html">current</a></span> : <code class="type"><a href="Clock.html#TYPEclock">clock</a></code></pre><div class="info">
We have only one clock so can run only one simulation at the same time.<br>
</div>
<pre><span id="VALnow"><span class="keyword">val</span> <a href="code_VALClock.now.html">now</a></span> : <code class="type">unit -> Time.t</code></pre><div class="info">
Return the current simulation time.<br>
</div>
<pre><span id="VALcond_lock"><span class="keyword">val</span> <a href="code_VALClock.cond_lock.html">cond_lock</a></span> : <code class="type">Mutex.t</code></pre><pre><span id="VALcond"><span class="keyword">val</span> <a href="code_VALClock.cond.html">cond</a></span> : <code class="type">Condition.t</code></pre><pre><span id="VALsignal_me"><span class="keyword">val</span> <a href="code_VALClock.signal_me.html">signal_me</a></span> : <code class="type">unit -> unit</code></pre><pre><span id="VALepsilon"><span class="keyword">val</span> <a href="code_VALClock.epsilon.html">epsilon</a></span> : <code class="type">Interval.t</code></pre><pre><span id="VALat"><span class="keyword">val</span> <a href="code_VALClock.at.html">at</a></span> : <code class="type">Map.key -> ('a -> unit) -> 'a -> unit</code></pre><div class="info">
<code class="code">at t f x</code> will execute <code class="code">f x</code> when simulation clock reachs time <code class="code">t</code>.<br>
</div>
<pre><span id="VALdelay"><span class="keyword">val</span> <a href="code_VALClock.delay.html">delay</a></span> : <code class="type">Interval.t -> ('a -> unit) -> 'a -> unit</code></pre><div class="info">
<code class="code">delay d f x</code> will delay the execution of <code class="code">f x</code> by the interval <code class="code">d</code>.<br>
</div>
<pre><span id="VALasap"><span class="keyword">val</span> <a href="code_VALClock.asap.html">asap</a></span> : <code class="type">('a -> unit) -> 'a -> unit</code></pre><pre><span id="VALsynch"><span class="keyword">val</span> <a href="code_VALClock.synch.html">synch</a></span> : <code class="type">unit -> unit</code></pre><div class="info">
Synchronize internal clock with realtime clock.
 You must call this after real time passes (for instance after a blocking call).
 Otherwise, time jumps from one registered event to the next.<br>
</div>
<pre><span id="VALnext_event"><span class="keyword">val</span> <a href="code_VALClock.next_event.html">next_event</a></span> : <code class="type">unit -> unit</code></pre><div class="info">
Will process the next event<br>
</div>
<pre><span id="VALrun"><span class="keyword">val</span> <a href="code_VALClock.run.html">run</a></span> : <code class="type">bool -> unit</code></pre><div class="info">
<code class="code">run <span class="keyword">true</span></code> will run forever while <code class="code">run <span class="keyword">false</span></code> will return once no more events are waiting.<br>
</div>
</body></html>