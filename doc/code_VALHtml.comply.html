<html><head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Arp" rel="Chapter" href="Arp.html">
<link title="Browser" rel="Chapter" href="Browser.html">
<link title="Clock" rel="Chapter" href="Clock.html">
<link title="Dhcp" rel="Chapter" href="Dhcp.html">
<link title="Dns" rel="Chapter" href="Dns.html">
<link title="Eth" rel="Chapter" href="Eth.html">
<link title="Fifo" rel="Chapter" href="Fifo.html">
<link title="Host" rel="Chapter" href="Host.html">
<link title="Html" rel="Chapter" href="Html.html">
<link title="Http" rel="Chapter" href="Http.html">
<link title="Hub" rel="Chapter" href="Hub.html">
<link title="Icmp" rel="Chapter" href="Icmp.html">
<link title="Ip" rel="Chapter" href="Ip.html">
<link title="Localhost" rel="Chapter" href="Localhost.html">
<link title="Log" rel="Chapter" href="Log.html">
<link title="Metric" rel="Chapter" href="Metric.html">
<link title="Myadmin" rel="Chapter" href="Myadmin.html">
<link title="Net" rel="Chapter" href="Net.html">
<link title="Opache" rel="Chapter" href="Opache.html">
<link title="Packet" rel="Chapter" href="Packet.html">
<link title="Pcap" rel="Chapter" href="Pcap.html">
<link title="Peg" rel="Chapter" href="Peg.html">
<link title="Persist" rel="Chapter" href="Persist.html">
<link title="Sll" rel="Chapter" href="Sll.html">
<link title="Tcp" rel="Chapter" href="Tcp.html">
<link title="Tools" rel="Chapter" href="Tools.html">
<link title="Udp" rel="Chapter" href="Udp.html">
<link title="Url" rel="Chapter" href="Url.html">
<link title="Vlan" rel="Chapter" href="Vlan.html"><title>Html.comply</title>
</head>
<body>
<code class="code"><span class="keyword">let</span>&nbsp;comply&nbsp;new_tag&nbsp;pending_tag&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;constraints&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;tag_in&nbsp;l&nbsp;=&nbsp;<span class="keyword">function</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">OpenTag</span>&nbsp;(t,&nbsp;_)&nbsp;<span class="keyword">when</span>&nbsp;not&nbsp;(<span class="constructor">List</span>.mem&nbsp;t&nbsp;l)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">false</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">CloseTag</span>&nbsp;t&nbsp;<span class="keyword">when</span>&nbsp;not&nbsp;(<span class="constructor">List</span>.mem&nbsp;t&nbsp;l)&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">false</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_empty&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Blank</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_pcdata&nbsp;=&nbsp;<span class="keyword">function</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Blank</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="keywordsign">`</span><span class="constructor">Content</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">true</span>&nbsp;<span class="keywordsign">|</span>&nbsp;_&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">false</span>&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_cdata&nbsp;x&nbsp;=&nbsp;is_pcdata&nbsp;x&nbsp;<span class="keyword">in</span>&nbsp;<span class="comment">(*&nbsp;?&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_fontstyle&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"tt"</span>;&nbsp;<span class="string">"i"</span>;&nbsp;<span class="string">"b"</span>;&nbsp;<span class="string">"big"</span>;&nbsp;<span class="string">"small"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_phrase&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"em"</span>;&nbsp;<span class="string">"strong"</span>;&nbsp;<span class="string">"dfn"</span>;&nbsp;<span class="string">"code"</span>;&nbsp;<span class="string">"samp"</span>;&nbsp;<span class="string">"kbd"</span>;&nbsp;<span class="string">"var"</span>;&nbsp;<span class="string">"cite"</span>;&nbsp;<span class="string">"abbr"</span>;&nbsp;<span class="string">"acronym"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_special&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"a"</span>;&nbsp;<span class="string">"img"</span>;&nbsp;<span class="string">"object"</span>;&nbsp;<span class="string">"br"</span>;&nbsp;<span class="string">"script"</span>;&nbsp;<span class="string">"map"</span>;&nbsp;<span class="string">"q"</span>;&nbsp;<span class="string">"sub"</span>;&nbsp;<span class="string">"sup"</span>;&nbsp;<span class="string">"span"</span>;&nbsp;<span class="string">"bdo"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_formctrl&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"input"</span>;&nbsp;<span class="string">"select"</span>;&nbsp;<span class="string">"textarea"</span>;&nbsp;<span class="string">"label"</span>;&nbsp;<span class="string">"button"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_inline&nbsp;x&nbsp;=&nbsp;is_pcdata&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_fontstyle&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_phrase&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_special&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_formctrl&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_heading&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"h1"</span>;&nbsp;<span class="string">"h2"</span>;&nbsp;<span class="string">"h3"</span>;&nbsp;<span class="string">"h4"</span>;&nbsp;<span class="string">"h5"</span>;&nbsp;<span class="string">"h6"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_list&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"ul"</span>;&nbsp;<span class="string">"ol"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_preformatted&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"pre"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_block&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"p"</span>;&nbsp;<span class="string">"dl"</span>;&nbsp;<span class="string">"div"</span>;&nbsp;<span class="string">"noscript"</span>;&nbsp;<span class="string">"blockquote"</span>;&nbsp;<span class="string">"form"</span>;&nbsp;<span class="string">"hr"</span>;&nbsp;<span class="string">"table"</span>;&nbsp;<span class="string">"fieldset"</span>;&nbsp;<span class="string">"address"</span>]&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_heading&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_list&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_preformatted&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_flow&nbsp;x&nbsp;=&nbsp;is_block&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_inline&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_tr&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"tr"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_col&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"col"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_bodyok&nbsp;x&nbsp;=&nbsp;is_block&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;tag_in&nbsp;[<span class="string">"script"</span>;&nbsp;<span class="string">"ins"</span>;&nbsp;<span class="string">"del"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_head_content&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"title"</span>;&nbsp;<span class="string">"base"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_head_misc&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"script"</span>;&nbsp;<span class="string">"style"</span>;&nbsp;<span class="string">"meta"</span>;&nbsp;<span class="string">"link"</span>;&nbsp;<span class="string">"object"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_headok&nbsp;x&nbsp;=&nbsp;is_head_content&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_head_misc&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_html_content&nbsp;x&nbsp;=&nbsp;tag_in&nbsp;[<span class="string">"head"</span>;&nbsp;<span class="string">"body"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_objectok&nbsp;x&nbsp;=&nbsp;is_flow&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;tag_in&nbsp;[<span class="string">"param"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_blockquoteok&nbsp;x&nbsp;=&nbsp;is_block&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;tag_in&nbsp;[<span class="string">"script"</span>]&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_formok&nbsp;x&nbsp;=&nbsp;not&nbsp;(tag_in&nbsp;[<span class="string">"form"</span>]&nbsp;x)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;(is_block&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;tag_in&nbsp;[<span class="string">"script"</span>]&nbsp;x)&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;is_labelok&nbsp;x&nbsp;=&nbsp;not&nbsp;(tag_in&nbsp;[<span class="string">"label"</span>]&nbsp;x)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;is_inline&nbsp;x&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;<span class="string">"tt"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"i"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"b"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"big"</span>,&nbsp;is_inline&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"small"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"em"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"strong"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"dfn"</span>,&nbsp;is_inline&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"code"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"samp"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"kbd"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"var"</span>,&nbsp;is_inline&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"cite"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"abbr"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"acronym"</span>,&nbsp;is_inline&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"sub"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"sup"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"span"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"bdo"</span>,&nbsp;is_inline&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"br"</span>,&nbsp;is_empty&nbsp;;&nbsp;<span class="string">"body"</span>,&nbsp;is_bodyok&nbsp;;&nbsp;<span class="string">"address"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"div"</span>,&nbsp;is_flow&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"a"</span>,&nbsp;(<span class="keyword">fun</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;not&nbsp;(tag_in&nbsp;[<span class="string">"a"</span>]&nbsp;x)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;is_inline&nbsp;x)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"map"</span>,&nbsp;is_block&nbsp;;&nbsp;<span class="string">"area"</span>,&nbsp;is_empty&nbsp;;&nbsp;<span class="string">"link"</span>,&nbsp;is_empty&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"img"</span>,&nbsp;is_empty&nbsp;;&nbsp;<span class="string">"object"</span>,&nbsp;is_objectok&nbsp;;&nbsp;<span class="string">"param"</span>,&nbsp;is_empty&nbsp;;&nbsp;<span class="string">"hr"</span>,&nbsp;is_empty&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"p"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"h1"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"h2"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"h3"</span>,&nbsp;is_inline&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"h4"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"h5"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"h6"</span>,&nbsp;is_inline&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"pre"</span>,&nbsp;(<span class="keyword">fun</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;not&nbsp;(tag_in&nbsp;[<span class="string">"img"</span>;<span class="string">"object"</span>;<span class="string">"big"</span>;<span class="string">"small"</span>;<span class="string">"sub"</span>;<span class="string">"sup"</span>]&nbsp;x)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;is_inline&nbsp;x)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"q"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"blockquote"</span>,&nbsp;is_blockquoteok&nbsp;;&nbsp;<span class="string">"ins"</span>,&nbsp;is_flow&nbsp;;&nbsp;<span class="string">"del"</span>,&nbsp;is_flow&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"dl"</span>,&nbsp;tag_in&nbsp;[<span class="string">"dt"</span>;<span class="string">"dd"</span>]&nbsp;;&nbsp;<span class="string">"dt"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"dd"</span>,&nbsp;is_flow&nbsp;;&nbsp;<span class="string">"ol"</span>,&nbsp;tag_in&nbsp;[<span class="string">"li"</span>]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"ul"</span>,&nbsp;tag_in&nbsp;[<span class="string">"li"</span>]&nbsp;;&nbsp;<span class="string">"li"</span>,&nbsp;is_flow&nbsp;;&nbsp;<span class="string">"form"</span>,&nbsp;is_formok&nbsp;;&nbsp;<span class="string">"label"</span>,&nbsp;is_labelok&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"input"</span>,&nbsp;is_empty&nbsp;;&nbsp;<span class="string">"select"</span>,&nbsp;tag_in&nbsp;[<span class="string">"optgroup"</span>;&nbsp;<span class="string">"option"</span>]&nbsp;;&nbsp;<span class="string">"legend"</span>,&nbsp;is_inline&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"optgroup"</span>,&nbsp;tag_in&nbsp;[<span class="string">"option"</span>]&nbsp;;&nbsp;<span class="string">"option"</span>,&nbsp;is_pcdata&nbsp;;&nbsp;<span class="string">"textarea"</span>,&nbsp;is_pcdata&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"fieldset"</span>,&nbsp;(<span class="keyword">fun</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;is_pcdata&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;is_flow&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;tag_in&nbsp;[<span class="string">"legend"</span>]&nbsp;x)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"button"</span>,&nbsp;(<span class="keyword">fun</span>&nbsp;x&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;not&nbsp;(is_formctrl&nbsp;x&nbsp;<span class="keywordsign">||</span>&nbsp;tag_in&nbsp;[<span class="string">"a"</span>;<span class="string">"form"</span>;<span class="string">"fieldset"</span>]&nbsp;x)&nbsp;<span class="keywordsign">&amp;&amp;</span>&nbsp;is_flow&nbsp;x)&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"table"</span>,&nbsp;tag_in&nbsp;[<span class="string">"caption"</span>;<span class="string">"col"</span>;<span class="string">"colgroup"</span>;<span class="string">"thead"</span>;<span class="string">"tfoot"</span>;<span class="string">"tbody"</span>]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"caption"</span>,&nbsp;is_inline&nbsp;;&nbsp;<span class="string">"thead"</span>,&nbsp;is_tr&nbsp;;&nbsp;<span class="string">"tfoot"</span>,&nbsp;is_tr&nbsp;;&nbsp;<span class="string">"tbody"</span>,&nbsp;is_tr&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"colgroup"</span>,&nbsp;is_col&nbsp;;&nbsp;<span class="string">"col"</span>,&nbsp;is_empty&nbsp;;&nbsp;<span class="string">"tr"</span>,&nbsp;tag_in&nbsp;[<span class="string">"th"</span>;&nbsp;<span class="string">"td"</span>]&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"th"</span>,&nbsp;is_flow&nbsp;;&nbsp;<span class="string">"td"</span>,&nbsp;is_flow&nbsp;;&nbsp;<span class="string">"head"</span>,&nbsp;is_headok&nbsp;;&nbsp;<span class="string">"title"</span>,&nbsp;is_pcdata&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"base"</span>,&nbsp;is_empty&nbsp;;&nbsp;<span class="string">"meta"</span>,&nbsp;is_empty&nbsp;;&nbsp;<span class="string">"style"</span>,&nbsp;is_cdata&nbsp;;&nbsp;<span class="string">"script"</span>,&nbsp;is_cdata&nbsp;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">"noscript"</span>,&nbsp;is_block&nbsp;;&nbsp;<span class="string">"html"</span>,&nbsp;is_html_content&nbsp;]&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;We&nbsp;are&nbsp;always&nbsp;allowed&nbsp;to&nbsp;close&nbsp;the&nbsp;opened&nbsp;tag&nbsp;*)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span>&nbsp;new_tag&nbsp;=&nbsp;<span class="keywordsign">`</span><span class="constructor">CloseTag</span>&nbsp;pending_tag&nbsp;<span class="keyword">then</span>&nbsp;<span class="keyword">true</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span>&nbsp;<span class="keyword">try</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;f&nbsp;=&nbsp;<span class="constructor">List</span>.assoc&nbsp;pending_tag&nbsp;constraints&nbsp;<span class="keyword">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f&nbsp;new_tag<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">with</span>&nbsp;<span class="constructor">Not_found</span>&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;<span class="keyword">true</span></code></body></html>